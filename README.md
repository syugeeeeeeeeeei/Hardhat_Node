# Hardhat_Node

## 📖 概要

このプロジェクトでは、`docker-compose` を使用して、スマートコントラクト開発に必要な全てのサービスをコンテナとして一括で起動します。これにより、ローカル環境を汚すことなく、誰でも同じ構成の開発環境を素早く構築できます。

提供される環境には、以下の3つのサービスが含まれます。

1.  **Anvil**: 高速なローカルEthereumテストネット。
2.  **Arlocal**: ローカルArweaveテストネット。
3.  **Hardhat**: スマートコントラクトのコンパイル、デプロイ、テストを行うための開発環境。

---

## 🔧 各サービスの詳細

### 1. Anvil (`local_anvil`)

Foundryチームが開発した、非常に高速で軽量なローカルEthereumノードです。

* **目的**: 開発中にスマートコントラクトをデプロイし、即座にテストするためのEVM (Ethereum Virtual Machine) 環境を提供します。
* **設定**:
    * `--block-base-fee-per-gas 0`: トランザクション手数料の計算を簡略化し、ガス代を予測しやすくしています。
    * `ports: - "8545:8545"`: ホストマシンのポート`8545`を介して、このAnvilノードにアクセスできます。`hardhat.config.ts` はこのポートを参照します。

### 2. Arlocal (`arlocal-instance`)

Arweaveの機能をローカルでシミュレートするためのテストネットです。

* **目的**: Arweaveネットワーク上で永続的なデータを保存するアプリケーション（permawebアプリ）を、実際にトークンを消費することなく開発・テストするために使用します。
* **設定**:
    * `command`: コンテナ起動時に`arlocal`をインストールし、永続化オプション付きで実行します。
    * `volumes`: `arlocal_data`という名前付きボリュームをマウントし、コンテナを再起動しても保存したデータが消えないようにします。
    * `ports: - "1984:1984"`: ホストマシンのポート`1984`を介して、このローカルArweaveノードにアクセスできます。

### 3. Hardhat (`local_hardhat`)

このプロジェクトの中心となる、スマートコントラクト開発環境です。

* **目的**: プロジェクトのコンパイル、デプロイ、スクリプト実行など、全ての開発作業を行うためのインタラクティブな環境です。
* **設定**:
    * `build`: `hardhat`ディレクトリ内の`Dockerfile`を元に、専用のDockerイメージをビルドします。
    * `volumes`:
        * `./hardhat:/app`: ホストマシンの`hardhat`ディレクトリをコンテナ内の`/app`ディレクトリに同期します。これにより、ローカルでコードを編集すると即座にコンテナ内に反映されます。
        * `/app/node_modules`: `node_modules`をコンテナ内に分離し、ホストマシンとコンテナ間での依存関係の競合を防ぎます。
    * `depends_on: - anvil`: `hardhat`サービスを起動する前に、依存先である`anvil`サービスが起動していることを保証します。
    * `tty: true`, `stdin_open: true`: コンテナ内でインタラクティブなシェル（コマンド入力）を利用できるようにします。

---

## 🚀 利用方法

### 1. 前提条件

* Docker
* Docker Compose

上記がマシンにインストールされている必要があります。

### 2. 環境の起動

プロジェクトのルートディレクトリ（`docker-compose.yml`がある場所）で、以下のコマンドを実行します。

```sh
# -d オプションでバックグラウンドで全サービスを起動
docker-compose up -d